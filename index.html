<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Efor Fiyat Takip Sistemi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #dc2626;
            --primary-dark: #991b1b;
            --primary-light: #ef4444;
            --success-color: #22c55e;
            --danger-color: #1d7f25;
            --warning-color: #f59e0b;
            --text-dark: #0f0f0f;
            --text-light: #f8fafc;
            --text-gray: #94a3b8;
            --bg-gradient: linear-gradient(135deg, #1a1a1a 0%, #267bdc 50%, #000000 100%);
            --card-bg: #1a1a1a;
            --card-border: #26dc44;
        }

        body {
            font-family: 'Inter', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: var(--text-dark);
            position: relative;
            overflow-x: hidden;
            line-height: 1.6;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 20% 50%, rgba(220, 38, 38, 0.4), transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 0, 0, 0.8), transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(239, 68, 68, 0.3), transparent 50%);
            z-index: -1;
            animation: gradientShift 15s ease infinite;
        }

        @keyframes gradientShift {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.8;
            }
        }

        /* Navbar - Daha modern ve profesyonel */
        .navbar {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px) saturate(180%);
            -webkit-backdrop-filter: blur(25px) saturate(180%);
            border-bottom: 2px solid rgba(220, 38, 38, 0.3);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 8px 32px rgba(220, 38, 38, 0.3);
        }

        .navbar-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .navbar-brand {
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #fff, #dc2626);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            letter-spacing: -0.5px;
        }

        .navbar-brand::before {
            content: "üí∞";
            font-size: 1.75rem;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
        }

        .navbar-user {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            background: rgba(220, 38, 38, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 2rem;
            border: 1px solid rgba(220, 38, 38, 0.5);
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.3);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            box-shadow: 0 4px 10px rgba(220, 38, 38, 0.4);
        }

        .user-email {
            font-size: 0.9rem;
            color: white;
            font-weight: 600;
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        /* Cards - Daha temiz ve modern */
        .card {
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 1.25rem;
            padding: 2rem;
            box-shadow:
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(220, 38, 38, 0.3);
            margin-bottom: 2rem;
            animation: fadeInUp 0.5s ease-out;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(220, 38, 38, 0.2);
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow:
                0 25px 70px rgba(220, 38, 38, 0.4),
                0 0 0 1px rgba(220, 38, 38, 0.5);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card-title {
            font-size: 1.75rem;
            font-weight: 800;
            margin-bottom: 1.75rem;
            color: #ffffff;
            display: flex;
            align-items: center;
            gap: 0.875rem;
            letter-spacing: -0.5px;
        }

        .card-title::before {
            content: "";
            width: 5px;
            height: 32px;
            background: linear-gradient(180deg, var(--primary-color), var(--primary-dark));
            border-radius: 4px;
            box-shadow: 0 4px 10px rgba(220, 38, 38, 0.3);
        }

        /* Form Styles - Daha modern input tasarƒ±mƒ± */
        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #e5e7eb;
            font-size: 0.95rem;
            letter-spacing: 0.2px;
        }

        input,
        select {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid #333333;
            border-radius: 0.75rem;
            font-size: 1rem;
            transition: all 0.3s ease;
            font-family: inherit;
            background: #1a1a1a;
            color: #ffffff;
            font-weight: 500;
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(220, 38, 38, 0.2);
            background: #0f0f0f;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary-color) !important;
            box-shadow: 0 0 0 4px rgba(220, 38, 38, 0.2);
            background: #0f0f0f;
        }

        input::placeholder {
            color: #6b7280;
            font-weight: 400;
        }

        /* Buttons - Daha profesyonel buton tasarƒ±mƒ± */
        .btn {
            width: 100%;
            padding: 0.875rem 1.75rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            letter-spacing: 0.3px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #991b1b, #7f1d1d);
            color: white;
        }

        .btn-small {
            padding: 0.5rem 1.25rem;
            font-size: 0.9rem;
            width: auto;
        }

        .btn-logout {
            padding: 0.5rem 1.5rem;
            font-size: 0.9rem;
            width: auto;
            background: rgba(220, 38, 38, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(220, 38, 38, 0.5);
            color: white;
        }

        .btn-logout:hover {
            background: rgba(127, 29, 29, 0.9);
            border-color: transparent;
        }

        /* Login Page - Daha zarif giri≈ü ekranƒ± */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 2rem;
        }

        .login-card {
            background: rgba(26, 26, 26, 0.98);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border-radius: 1.5rem;
            padding: 3rem 2.5rem;
            box-shadow:
                0 30px 80px rgba(0, 0, 0, 0.8),
                0 0 0 1px rgba(220, 38, 38, 0.5);
            border: 2px solid rgba(220, 38, 38, 0.3);
            width: 100%;
            max-width: 440px;
            animation: scaleIn 0.5s ease-out;
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .login-title {
            text-align: center;
            font-size: 2.25rem;
            font-weight: 900;
            margin-bottom: 0.75rem;
            background: linear-gradient(135deg, var(--primary-color), #ef4444);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -1px;
        }

        .login-subtitle {
            text-align: center;
            font-size: 1rem;
            color: var(--text-gray);
            margin-bottom: 2rem;
            font-weight: 500;
        }

        /* Tables - Daha temiz tablo tasarƒ±mƒ± */
        .table-container {
            overflow-x: auto;
            margin-top: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .table-container-users {
            max-height: 300px;
            overflow-y: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #1a1a1a;
        }

        th,
        td {
            padding: 1rem 1.25rem;
            text-align: left;
            border-bottom: 1px solid #333333;
        }

        th {
            background: linear-gradient(135deg, #0f0f0f, #1a1a1a);
            font-weight: 700;
            color: #dc2626;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid #dc2626;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        td {
            font-size: 0.95rem;
            color: #e5e7eb;
            font-weight: 500;
        }

        tr:hover {
            background: rgba(220, 38, 38, 0.1);
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        /* Tabs - Daha modern tab tasarƒ±mƒ± */
        .tabs {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 2rem;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            padding: 0.5rem;
            border-radius: 1rem;
            flex-wrap: wrap;
            box-shadow: 0 2px 10px rgba(220, 38, 38, 0.2);
            border: 1px solid rgba(220, 38, 38, 0.2);
        }

        .tab {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: none;
            border-radius: 0.75rem;
            cursor: pointer;
            font-weight: 700;
            color: #9ca3af;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-size: 0.95rem;
        }

        .tab:hover {
            color: #dc2626;
            background: rgba(220, 38, 38, 0.15);
            transform: none;
            box-shadow: none;
        }

        .tab.active {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Price Display - Daha ≈üƒ±k fiyat g√∂sterimi */
        .price-display {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark), #dc2626);
            color: white;
            padding: 2.5rem;
            border-radius: 1.25rem;
            text-align: center;
            margin-top: 2rem;
            box-shadow: 0 20px 50px rgba(220, 38, 38, 0.35);
            position: relative;
            overflow: hidden;
        }

        .price-display::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1), transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
                opacity: 0.5;
            }

            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }
        }

        .price-label {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 0.75rem;
            font-weight: 600;
            position: relative;
            z-index: 1;
        }

        .price-amount {
            font-size: 3.5rem;
            font-weight: 900;
            position: relative;
            z-index: 1;
            text-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            letter-spacing: -2px;
        }

        .price-details {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 1;
        }

        .price-item {
            display: flex;
            justify-content: space-between;
            padding: 0.625rem 0;
            font-size: 1rem;
            font-weight: 600;
        }

        /* Checkbox Group - Daha modern se√ßim kutularƒ± */
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 1rem 1.25rem;
            background: #0f0f0f;
            border: 2px solid #333333;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkbox-item:hover {
            background: #1a1a1a;
            border-color: var(--primary-light);
            transform: translateX(5px);
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 1rem;
            cursor: pointer;
            accent-color: var(--primary-color);
        }

        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            flex: 1;
            font-size: 1rem;
            color: #e5e7eb;
            font-weight: 600;
        }

        /* Alerts - Daha temiz uyarƒ±lar */
        .alert {
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
            display: none;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .alert.show {
            display: block;
            animation: slideDown 0.4s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-15px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .alert-success {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            color: #065f46;
            border-left: 4px solid var(--success-color);
        }

        .alert-error {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            color: #991b1b;
            border-left: 4px solid var(--danger-color);
        }

        .hidden {
            display: none !important;
        }

        /* Form Grid */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        /* Edit Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(30px);
            border-radius: 1.25rem;
            padding: 2.5rem;
            box-shadow:
                0 30px 80px rgba(220, 38, 38, 0.3),
                0 0 0 1px rgba(220, 38, 38, 0.5);
            border: 2px solid rgba(220, 38, 38, 0.3);
            width: 90%;
            max-width: 500px;
            animation: scaleIn 0.3s ease-out;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: white;
        }

        .modal-close {
            background: none;
            border: none;
            color: #9ca3af;
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: var(--primary-color);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .navbar-container {
                padding: 0 1.5rem;
            }

            .navbar-brand {
                font-size: 1.25rem;
            }

            .user-email {
                display: none;
            }

            .card {
                padding: 1.5rem;
            }

            .card-title {
                font-size: 1.5rem;
            }

            .login-card {
                padding: 2.5rem 2rem;
            }

            .login-title {
                font-size: 2rem;
            }

            .price-amount {
                font-size: 2.5rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .tabs {
                padding: 0.4rem;
            }

            .tab {
                padding: 0.65rem 1.25rem;
                font-size: 0.9rem;
            }

            th,
            td {
                padding: 0.875rem 1rem;
                font-size: 0.875rem;
            }

            .modal-content {
                padding: 2rem 1.5rem;
                margin: 1rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 1rem;
            }

            .login-card {
                padding: 2rem 1.5rem;
            }

            .card {
                padding: 1.25rem;
            }
        }




        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #dc2626;
            --primary-dark: #991b1b;
            --primary-light: #ef4444;
            --success-color: #22c55e;
            --danger-color: #1d7f25;
            --warning-color: #f59e0b;
            --text-dark: #0f0f0f;
            --text-light: #f8fafc;
            --text-gray: #94a3b8;
            --bg-gradient: linear-gradient(135deg, #1a1a1a 0%, #267bdc 50%, #000000 100%);
        }

        body {
            font-family: 'Inter', 'Segoe UI', sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: var(--text-dark);
            line-height: 1.6;
            position: relative;
            overflow-x: hidden;
        }

        /* ... Diƒüer t√ºm stiller (navbar, card, table, btn, inputs vb.) burada olmalƒ± ... */

        /* √ñnceki kodunuzdaki CSS'in tamamƒ±nƒ± buraya dahil ettiƒüinizi varsayƒ±yoruz. 
           Sistem loglarƒ± i√ßin mevcut 'table', 'card' ve 'tab' sƒ±nƒ±flarƒ± yeterlidir. */

        /* Gerekli temel sƒ±nƒ±flar (Kopyala-yapƒ±≈ütƒ±r yaparken kaybolmasƒ±n diye √∂zet): */
        .hidden {
            display: none !important;
        }

        .navbar {
            background: rgba(0, 0, 0, 0.9);
            padding: 1rem 0;
            color: white;
            display: flex;
            justify-content: space-between;
        }

        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .card {
            background: rgba(26, 26, 26, 0.95);
            padding: 2rem;
            border-radius: 1.25rem;
            margin-bottom: 2rem;
            color: white;
        }

        .tabs {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 2rem;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            background: transparent;
            color: #9ca3af;
            border: none;
            cursor: pointer;
            border-radius: 0.75rem;
            font-weight: bold;
        }

        .tab.active {
            background: #dc2626;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            color: white;
        }

        th,
        td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #333;
        }

        .alert {
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 0.5rem;
            display: none;
        }

        .alert.show {
            display: block;
        }

        .alert-success {
            background: #d1fae5;
            color: #065f46;
        }

        .alert-error {
            background: #fee2e2;
            color: #991b1b;
        }

        /* ... */
    </style>
</head>

<body>
    <div id="loginPage" class="login-container"
        style="display: flex; justify-content: center; align-items: center; min-height: 100vh;">
        <div class="login-card"
            style="background: rgba(26,26,26,0.95); padding: 3rem; border-radius: 1.5rem; width: 100%; max-width: 440px; color: white;">
            <h1 class="login-title" style="text-align: center; color: #dc2626; margin-bottom: 1rem;">üí∞ Efor Giri≈ü</h1>
            <p class="login-subtitle" style="text-align: center; color: #9ca3af; margin-bottom: 2rem;">Devam etmek i√ßin
                hesabƒ±nƒ±za giri≈ü yapƒ±n</p>
            <div id="loginAlert" class="alert"></div>
            <form id="loginForm">
                <div class="form-group" style="margin-bottom: 1.5rem;">
                    <label for="email" style="display: block; margin-bottom: 0.5rem;">E-posta Adresi</label>
                    <input type="email" id="email" placeholder="ornek@efor.com" required
                        style="width: 100%; padding: 0.8rem; border-radius: 0.5rem; border: 1px solid #333; background: #1a1a1a; color: white;">
                </div>
                <div class="form-group" style="margin-bottom: 1.5rem;">
                    <label for="password" style="display: block; margin-bottom: 0.5rem;">≈ûifre</label>
                    <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required
                        style="width: 100%; padding: 0.8rem; border-radius: 0.5rem; border: 1px solid #333; background: #1a1a1a; color: white;">
                </div>
                <button type="submit" class="btn btn-primary"
                    style="width: 100%; padding: 1rem; background: #dc2626; color: white; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: bold;">Giri≈ü
                    Yap ‚Üí</button>
            </form>
        </div>
    </div>

    <div id="mainApp" class="hidden">
        <nav class="navbar" style="padding: 1rem 2rem;">
            <div class="navbar-container"
                style="width: 100%; max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
                <div class="navbar-brand" style="font-size: 1.5rem; font-weight: bold; color: #dc2626;">
                    Efor Fiyat Takip Sistemi
                </div>
                <div class="navbar-user" style="display: flex; align-items: center; gap: 1rem;">
                    <div class="user-info"
                        style="display: flex; align-items: center; gap: 0.5rem; background: rgba(220,38,38,0.2); padding: 0.5rem 1rem; border-radius: 2rem;">
                        <div class="user-avatar" id="userAvatar"
                            style="width: 32px; height: 32px; background: #dc2626; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold;">
                        </div>
                        <span class="user-email" id="userEmailDisplay" style="color: white; font-size: 0.9rem;"></span>
                    </div>
                    <button class="btn btn-danger btn-logout" onclick="logout()"
                        style="padding: 0.5rem 1.5rem; background: rgba(220,38,38,0.2); border: 1px solid #dc2626; color: white; border-radius: 0.5rem; cursor: pointer;">√áƒ±kƒ±≈ü</button>
                </div>
            </div>
        </nav>

        <div class="container">
            <div id="adminPanel" class="hidden">
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('users')">üë• Kullanƒ±cƒ± Y√∂netimi</button>
                    <button class="tab" onclick="switchTab('parts')">üîß Par√ßa Y√∂netimi</button>
                    <button class="tab" onclick="switchTab('prices')">üí∞ Fiyat Listesi</button>
                    <button class="tab" onclick="switchTab('logs')">üìä Sistem Loglarƒ±</button>
                </div>

                <div id="usersTab" class="tab-content active">
                    <div class="card">
                        <h2 class="card-title">Yeni Kullanƒ±cƒ± Ekle</h2>
                        <div id="userAlert" class="alert"></div>
                        <form id="addUserForm">
                            <div class="form-grid"
                                style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                                <div class="form-group">
                                    <label for="newUserEmail">E-posta</label>
                                    <input type="email" id="newUserEmail" required
                                        style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                                </div>
                                <div class="form-group">
                                    <label for="newUserPassword">≈ûifre</label>
                                    <input type="password" id="newUserPassword" required
                                        style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-success"
                                style="width: 100%; padding: 0.8rem; background: #22c55e; color: white; border: none; border-radius: 0.5rem; cursor: pointer;">‚úì
                                Kullanƒ±cƒ± Ekle</button>
                        </form>
                    </div>

                    <div class="card">
                        <h2 class="card-title">Kullanƒ±cƒ± Listesi</h2>
                        <div class="table-container table-container-users">
                            <table>
                                <thead>
                                    <tr>
                                        <th>E-posta</th>
                                        <th>Olu≈üturulma</th>
                                        <th>ƒ∞≈ülem</th>
                                    </tr>
                                </thead>
                                <tbody id="usersList"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="partsTab" class="tab-content">
                    <div class="card">
                        <h2 class="card-title">Yeni Par√ßa Ekle</h2>
                        <div id="partAlert" class="alert"></div>
                        <form id="addPartForm">
                            <div class="form-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div class="form-group">
                                    <label for="partBrand">Marka</label>
                                    <input type="text" id="partBrand" placeholder="√ñrn: Apple" required
                                        style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                                </div>
                                <div class="form-group">
                                    <label for="partModel">Model</label>
                                    <input type="text" id="partModel" placeholder="√ñrn: iPhone 14" required
                                        style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                                </div>
                            </div>
                            <div class="form-group" style="margin: 1rem 0;">
                                <label for="partName">Par√ßa Adƒ±</label>
                                <input type="text" id="partName" placeholder="√ñrn: Ekran" required
                                    style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                            </div>
                            <div class="form-grid"
                                style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                                <div class="form-group">
                                    <label for="partPriceOriginal">Orijinal Fiyat (‚Ç∫)</label>
                                    <input type="number" id="partPriceOriginal" placeholder="0.00" step="0.01" required
                                        style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                                </div>
                                <div class="form-group">
                                    <label for="partPriceEquivalent">Muadil Fiyat (‚Ç∫) <span
                                            style="color: #94a3b8; font-weight: 400;">(ƒ∞steƒüe baƒülƒ±)</span></label>
                                    <input type="number" id="partPriceEquivalent" placeholder="0.00" step="0.01"
                                        style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-success"
                                style="width: 100%; padding: 0.8rem; background: #22c55e; color: white; border: none; border-radius: 0.5rem; cursor: pointer;">‚úì
                                Par√ßa Ekle</button>
                        </form>
                    </div>
                </div>

                <div id="pricesTab" class="tab-content">
                    <div class="card">
                        <h2 class="card-title">Fiyat Listesi</h2>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Marka</th>
                                        <th>Model</th>
                                        <th>Par√ßa</th>
                                        <th>Orijinal Fiyat</th>
                                        <th>Muadil Fiyat</th>
                                        <th>ƒ∞≈ülem</th>
                                    </tr>
                                </thead>
                                <tbody id="adminPricesList"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="logsTab" class="tab-content">
                    <div class="form-grid"
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 1.5rem;">
                        <div class="card">
                            <h2 class="card-title">üîê Giri≈ü/√áƒ±kƒ±≈ü Hareketleri</h2>
                            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Kullanƒ±cƒ±</th>
                                            <th>ƒ∞≈ülem</th>
                                            <th>Tarih/Saat</th>
                                        </tr>
                                    </thead>
                                    <tbody id="authLogsList"></tbody>
                                </table>
                            </div>
                        </div>

                        <div class="card">
                            <h2 class="card-title">üí∞ Fiyat Hesaplama Ge√ßmi≈üi</h2>
                            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Kullanƒ±cƒ±</th>
                                            <th>Detay (Marka/Model)</th>
                                            <th>Tutar</th>
                                            <th>Tarih/Saat</th>
                                        </tr>
                                    </thead>
                                    <tbody id="calcLogsList"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="userPanel" class="hidden">
                <div class="tabs">
                    <button class="tab active" onclick="switchUserTab('calculate')">üí∞ Fiyat Hesaplama</button>
                    <button class="tab" onclick="switchUserTab('list')">üìã Fiyat Listesi</button>
                    <button class="tab" onclick="switchUserTab('contact')">üìû ƒ∞leti≈üim</button>
                </div>

                <div id="calculateTab" class="tab-content active">
                    <div class="card">
                        <h2 class="card-title">Fiyat Hesaplama</h2>
                        <div id="userAlert" class="alert"></div>

                        <div class="form-group" style="margin-bottom: 1rem;">
                            <label for="selectBrand">Marka Se√ßin</label>
                            <select id="selectBrand" required
                                style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                                <option value="">-- Marka Se√ßin --</option>
                            </select>
                        </div>

                        <div class="form-group" id="modelGroup" style="display: none; margin-bottom: 1rem;">
                            <label for="selectModel">Model Se√ßin</label>
                            <select id="selectModel" required
                                style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                                <option value="">-- Model Se√ßin --</option>
                            </select>
                        </div>

                        <div class="form-group" id="partsGroup" style="display: none; margin-bottom: 1rem;">
                            <label>Par√ßa Se√ßin (En az 1, en fazla 3)</label>
                            <div class="checkbox-group" id="partsList"
                                style="display: flex; flex-direction: column; gap: 0.5rem;"></div>
                        </div>

                        <button id="calculateBtn" class="btn btn-primary"
                            style="display: none; width: 100%; padding: 1rem; background: #dc2626; color: white; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: bold;">üí∞
                            Fiyat Hesapla</button>

                        <div id="priceResult" style="display: none; margin-top: 2rem;">
                            <div class="price-display"
                                style="background: linear-gradient(135deg, #dc2626, #991b1b); padding: 2rem; border-radius: 1rem; text-align: center;">
                                <div class="price-label">Toplam Tutar</div>
                                <div class="price-amount" id="totalPrice" style="font-size: 3rem; font-weight: 900;">0 ‚Ç∫
                                </div>
                                <div class="price-details" id="priceBreakdown"
                                    style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.2);">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="listTab" class="tab-content">
                    <div class="card">
                        <h2 class="card-title">Fiyat Listesi</h2>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Marka</th>
                                        <th>Model</th>
                                        <th>Par√ßa</th>
                                        <th>Orijinal Fiyat</th>
                                        <th>Muadil Fiyat</th>
                                    </tr>
                                </thead>
                                <tbody id="userPricesList"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="contactTab" class="tab-content">
                    <div class="card">
                        <h2 class="card-title">ƒ∞leti≈üim Formu</h2>
                        <div id="contactAlert" class="alert"></div>
                        <form id="contactForm">
                            <div class="form-grid"
                                style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                                <div class="form-group">
                                    <label for="contactName">Ad Soyad</label>
                                    <input type="text" id="contactName" required
                                        style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                                </div>
                                <div class="form-group">
                                    <label for="contactEmail">E-posta</label>
                                    <input type="email" id="contactEmail"
                                        style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                                </div>
                            </div>
                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label for="contactPhone">Telefon</label>
                                <input type="tel" id="contactPhone"
                                    style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                            </div>
                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label for="contactSubject">Konu</label>
                                <select id="contactSubject" required
                                    style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                                    <option value="">-- Konu Se√ßin --</option>
                                    <option value="Genel Bilgi">Genel Bilgi</option>
                                    <option value="Fiyat Talebi">Fiyat Talebi</option>
                                    <option value="Diƒüer">Diƒüer</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label for="contactMessage">Mesajƒ±nƒ±z</label>
                                <textarea id="contactMessage" rows="6" required
                                    style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;"></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary"
                                style="width: 100%; padding: 1rem; background: #dc2626; color: white; border: none; border-radius: 0.5rem;">üì®
                                Mesaj G√∂nder</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="editPartModal" class="modal"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center;">
        <div class="modal-content"
            style="background: rgba(26,26,26,0.95); padding: 2rem; border-radius: 1rem; width: 90%; max-width: 500px; color: white;">
            <div class="modal-header" style="display: flex; justify-content: space-between; margin-bottom: 2rem;">
                <h3 class="modal-title" style="font-size: 1.5rem;">Par√ßa D√ºzenle</h3>
                <button class="modal-close" onclick="closeEditModal()"
                    style="background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer;">√ó</button>
            </div>
            <div id="editPartAlert" class="alert"></div>
            <form id="editPartForm">
                <input type="hidden" id="editPartKey">
                <div class="form-grid"
                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <div class="form-group">
                        <label for="editPartBrand">Marka</label>
                        <input type="text" id="editPartBrand" required
                            style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                    </div>
                    <div class="form-group">
                        <label for="editPartModel">Model</label>
                        <input type="text" id="editPartModel" required
                            style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                    </div>
                </div>
                <div class="form-group" style="margin-bottom: 1rem;">
                    <label for="editPartName">Par√ßa Adƒ±</label>
                    <input type="text" id="editPartName" required
                        style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                </div>
                <div class="form-grid"
                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <div class="form-group">
                        <label for="editPartPriceOriginal">Orijinal Fiyat (‚Ç∫)</label>
                        <input type="number" id="editPartPriceOriginal" step="0.01" required
                            style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                    </div>
                    <div class="form-group">
                        <label for="editPartPriceEquivalent">Muadil Fiyat (‚Ç∫)</label>
                        <input type="number" id="editPartPriceEquivalent" step="0.01"
                            style="width: 100%; padding: 0.8rem; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 0.5rem;">
                    </div>
                </div>
                <div class="form-grid" style="display: flex; gap: 1rem;">
                    <button type="submit" class="btn btn-success"
                        style="flex: 1; padding: 0.8rem; background: #22c55e; color: white; border: none; border-radius: 0.5rem; cursor: pointer;">‚úì
                        Kaydet</button>
                    <button type="button" class="btn btn-danger" onclick="closeEditModal()"
                        style="flex: 1; padding: 0.8rem; background: #991b1b; color: white; border: none; border-radius: 0.5rem; cursor: pointer;">ƒ∞ptal</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDdDsw6GReOb7Q09rgv_YyGlBo7Y175jGU",
            authDomain: "efor-fbd0d.firebaseapp.com",
            databaseURL: "https://efor-fbd0d-default-rtdb.firebaseio.com",
            projectId: "efor-fbd0d",
            storageBucket: "efor-fbd0d.firebasestorage.app",
            messagingSenderId: "836504681191",
            appId: "1:836504681191:web:506b05c9134ab76f910042"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        // Admin email
        const ADMIN_EMAIL = 'admin@servis.com';

        let currentUser = null;
        let isAdmin = false;

        // Auth State Observer
        auth.onAuthStateChanged(user => {
            if (user) {
                currentUser = user;
                isAdmin = user.email === ADMIN_EMAIL;

                if (!isAdmin) {
                    database.ref('users/' + user.uid).once('value', snapshot => {
                        if (!snapshot.exists()) {
                            auth.signOut();
                            showAlert('loginAlert', 'Hesabƒ±nƒ±z sistem y√∂neticisi tarafƒ±ndan kaldƒ±rƒ±lmƒ±≈ü.', 'error');
                        } else {
                            showMainApp();
                        }
                    });
                } else {
                    showMainApp();
                }
            } else {
                currentUser = null;
                showLoginPage();
            }
        });

        // Show Alert
        function showAlert(elementId, message, type) {
            const alert = document.getElementById(elementId);
            alert.textContent = message;
            alert.className = `alert alert-${type} show`;
            setTimeout(() => {
                alert.classList.remove('show');
            }, 5000);
        }

        // Login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            try {
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                const user = userCredential.user;

                // Admin deƒüilse veritabanƒ± kontrol√º
                if (user.email !== ADMIN_EMAIL) {
                    const snapshot = await database.ref('users/' + user.uid).once('value');
                    if (!snapshot.exists()) {
                        await auth.signOut();
                        showAlert('loginAlert', 'Hesabƒ±nƒ±z bulunamadƒ±.', 'error');
                        return;
                    }
                }

                // --- Gƒ∞Rƒ∞≈û LOGU ---
                try {
                    const loginLog = {
                        category: 'AUTH',
                        action: 'Giri≈ü Yapƒ±ldƒ±',
                        userEmail: user.email,
                        userId: user.uid,
                        timestamp: firebase.database.ServerValue.TIMESTAMP
                    };
                    await database.ref('system_logs').push(loginLog);
                    console.log('‚úÖ Giri≈ü logu kaydedildi:', user.email);
                } catch (logError) {
                    console.error('‚ùå Giri≈ü logu hatasƒ±:', logError);
                }
                // ------------------

            } catch (error) {
                showAlert('loginAlert', 'Giri≈ü ba≈üarƒ±sƒ±z: ' + error.message, 'error');
            }
        });

        // Logout
        async function logout() {
            // --- √áIKI≈û LOGU ---
            if (currentUser) {
                try {
                    const logoutLog = {
                        category: 'AUTH',
                        action: '√áƒ±kƒ±≈ü Yapƒ±ldƒ±',
                        userEmail: currentUser.email,
                        userId: currentUser.uid,
                        timestamp: firebase.database.ServerValue.TIMESTAMP
                    };
                    await database.ref('system_logs').push(logoutLog);
                    console.log('‚úÖ √áƒ±kƒ±≈ü logu kaydedildi:', currentUser.email);
                } catch (logError) {
                    console.error('‚ùå √áƒ±kƒ±≈ü logu hatasƒ±:', logError);
                }
            }
            // ------------------
            auth.signOut();
        }

        // Show Pages
        function showLoginPage() {
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('mainApp').classList.add('hidden');
        }

        function showMainApp() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mainApp').classList.remove('hidden');

            const avatar = document.getElementById('userAvatar');
            const emailDisplay = document.getElementById('userEmailDisplay');
            avatar.textContent = currentUser.email.charAt(0).toUpperCase();
            emailDisplay.textContent = currentUser.email;

            if (isAdmin) {
                document.getElementById('adminPanel').classList.remove('hidden');
                document.getElementById('userPanel').classList.add('hidden');
                loadUsers();
                loadAdminPrices();
                loadSystemLogs(); // <-- ADMƒ∞N Gƒ∞Rƒ∞NCE LOGLARI Y√úKLE
            } else {
                document.getElementById('adminPanel').classList.add('hidden');
                document.getElementById('userPanel').classList.remove('hidden');
                loadBrands();
                loadUserPrices();
            }
        }

        // --- LOGLARI Y√úKLEME FONKSƒ∞YONU ---
        function loadSystemLogs() {
            console.log('üìä Sistem loglarƒ± y√ºkleniyor...');

            // Son 100 logu getir ve ger√ßek zamanlƒ± g√ºncelle
            database.ref('system_logs').limitToLast(100).on('value', snapshot => {
                const authList = document.getElementById('authLogsList');
                const calcList = document.getElementById('calcLogsList');

                if (!authList || !calcList) {
                    console.error('‚ùå Log tablolarƒ± bulunamadƒ±!');
                    return;
                }

                authList.innerHTML = '';
                calcList.innerHTML = '';

                // Loglarƒ± tersten sƒ±ralamak i√ßin array'e alalƒ±m
                const logs = [];
                snapshot.forEach(child => {
                    const logData = child.val();
                    if (logData) {
                        logs.push({ id: child.key, ...logData });
                    }
                });

                logs.reverse(); // En yeniden eskiye

                let authCount = 0;
                let calcCount = 0;

                logs.forEach(log => {
                    try {
                        const date = new Date(log.timestamp).toLocaleString('tr-TR', {
                            day: '2-digit',
                            month: '2-digit',
                            year: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit',
                            second: '2-digit'
                        });

                        if (log.category === 'AUTH') {
                            authCount++;
                            const row = authList.insertRow();
                            const isLogin = log.action && log.action.includes('Giri≈ü');
                            const color = isLogin ? '#22c55e' : '#ef4444';
                            const icon = isLogin ? 'üîì' : 'üîí';

                            row.innerHTML = `
                                <td style="color: #e5e7eb;">${log.userEmail || 'Bilinmeyen'}</td>
                                <td style="color: ${color}; font-weight: bold;">${icon} ${log.action || 'ƒ∞≈ülem'}</td>
                                <td style="color: #9ca3af; font-size: 0.9rem;">${date}</td>
                            `;
                        } else if (log.category === 'CALCULATION') {
                            calcCount++;
                            const row = calcList.insertRow();
                            const details = log.details || {};
                            const detailText = details.brand ?
                                `<strong style="color: #dc2626;">${details.brand} ${details.model}</strong><br><span style="font-size:0.85rem; color:#9ca3af;">${details.parts || 'Par√ßa bilgisi yok'}</span>` :
                                '<span style="color: #6b7280;">Detay yok</span>';

                            row.innerHTML = `
                                <td style="color: #e5e7eb;">${log.userEmail || 'Bilinmeyen'}</td>
                                <td>${detailText}</td>
                                <td style="color: #22c55e; font-weight: bold; font-size: 1.05rem;">${details.totalPrice ? details.totalPrice.toFixed(2) + ' ‚Ç∫' : '-'}</td>
                                <td style="color: #9ca3af; font-size: 0.9rem;">${date}</td>
                            `;
                        }
                    } catch (error) {
                        console.error('‚ùå Log i≈üleme hatasƒ±:', error, log);
                    }
                });

                console.log(`‚úÖ Loglar y√ºklendi: ${authCount} giri≈ü/√ßƒ±kƒ±≈ü, ${calcCount} hesaplama`);

                // Eƒüer hi√ß log yoksa bilgilendirme g√∂ster
                if (authCount === 0) {
                    authList.innerHTML = '<tr><td colspan="3" style="text-align: center; color: #6b7280; padding: 2rem;">Hen√ºz giri≈ü/√ßƒ±kƒ±≈ü logu bulunmuyor</td></tr>';
                }
                if (calcCount === 0) {
                    calcList.innerHTML = '<tr><td colspan="4" style="text-align: center; color: #6b7280; padding: 2rem;">Hen√ºz fiyat hesaplama logu bulunmuyor</td></tr>';
                }
            }, error => {
                console.error('‚ùå Loglarƒ± y√ºkleme hatasƒ±:', error);
            });
        }
        // --------------------------------------------------

        // Tab Switching (Admin)
        function switchTab(tabName) {
            const tabs = document.querySelectorAll('#adminPanel .tab');
            const contents = document.querySelectorAll('#adminPanel .tab-content');

            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));

            // Eƒüer tƒ±klanan element butonsa onu, deƒüilse parent'ƒ±nƒ± al (target garantisi)
            const clickedTab = event.target;
            clickedTab.classList.add('active');

            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        // Tab Switching (User)
        function switchUserTab(tabName) {
            const tabs = document.querySelectorAll('#userPanel .tab');
            const contents = document.querySelectorAll('#userPanel .tab-content');

            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        // Add User
        document.getElementById('addUserForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('newUserEmail').value;
            const password = document.getElementById('newUserPassword').value;

            try {
                const response = await fetch('https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=' + firebaseConfig.apiKey, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password, returnSecureToken: true })
                });

                const data = await response.json();

                if (data.localId) {
                    await database.ref('users/' + data.localId).set({
                        email: email,
                        createdAt: Date.now(),
                        createdBy: currentUser.uid
                    });

                    showAlert('userAlert', 'Kullanƒ±cƒ± ba≈üarƒ±yla eklendi!', 'success');
                    document.getElementById('addUserForm').reset();
                    loadUsers(); // Refresh list
                } else if (data.error) {
                    throw new Error(data.error.message);
                }
            } catch (error) {
                showAlert('userAlert', 'Hata: ' + error.message, 'error');
            }
        });

        // Load Users
        function loadUsers() {
            database.ref('users').on('value', snapshot => {
                const tbody = document.getElementById('usersList');
                tbody.innerHTML = '';
                snapshot.forEach(child => {
                    const user = child.val();
                    if (user.email === ADMIN_EMAIL) return;

                    const row = tbody.insertRow();
                    const createdDate = new Date(user.createdAt).toLocaleDateString('tr-TR');

                    row.innerHTML = `
                        <td>${user.email}</td>
                        <td>${createdDate}</td>
                        <td><button class="btn btn-danger btn-small" onclick="deleteUser('${child.key}', '${user.email}')" style="padding: 0.5rem; background: #991b1b; color: white; border: none; border-radius: 0.3rem;">üóëÔ∏è Sil</button></td>
                    `;
                });
            });
        }

        async function deleteUser(userId, email) {
            if (confirm(`${email} kullanƒ±cƒ±sƒ±nƒ± silmek istediƒüinize emin misiniz?`)) {
                await database.ref('users/' + userId).remove();
                showAlert('userAlert', 'Kullanƒ±cƒ± silindi.', 'success');
            }
        }

        // Add Part
        document.getElementById('addPartForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const brand = document.getElementById('partBrand').value;
            const model = document.getElementById('partModel').value;
            const name = document.getElementById('partName').value;
            const priceOriginal = parseFloat(document.getElementById('partPriceOriginal').value);
            const priceEquivalent = parseFloat(document.getElementById('partPriceEquivalent').value) || null;

            try {
                await database.ref('parts').push({
                    brand, model, name, priceOriginal, priceEquivalent, createdAt: Date.now()
                });
                showAlert('partAlert', 'Par√ßa eklendi!', 'success');
                document.getElementById('addPartForm').reset();
            } catch (error) {
                showAlert('partAlert', 'Hata: ' + error.message, 'error');
            }
        });

        // Load Admin Prices
        function loadAdminPrices() {
            database.ref('parts').on('value', snapshot => {
                const tbody = document.getElementById('adminPricesList');
                tbody.innerHTML = '';
                snapshot.forEach(child => {
                    const part = child.val();
                    const row = tbody.insertRow();
                    const orig = part.priceOriginal ? part.priceOriginal.toFixed(2) + ' ‚Ç∫' : '-';
                    const equiv = part.priceEquivalent ? part.priceEquivalent.toFixed(2) + ' ‚Ç∫' : '-';

                    row.innerHTML = `
                        <td>${part.brand}</td>
                        <td>${part.model}</td>
                        <td>${part.name}</td>
                        <td>${orig}</td>
                        <td>${equiv}</td>
                        <td>
                            <button onclick="editPart('${child.key}')" style="padding: 0.4rem; background: #f59e0b; border: none; border-radius: 0.3rem; margin-right: 0.5rem; cursor: pointer;">‚úèÔ∏è</button>
                            <button onclick="deletePart('${child.key}')" style="padding: 0.4rem; background: #991b1b; border: none; border-radius: 0.3rem; color: white; cursor: pointer;">üóëÔ∏è</button>
                        </td>
                    `;
                });
            });
        }

        // Load User Prices
        function loadUserPrices() {
            database.ref('parts').on('value', snapshot => {
                const tbody = document.getElementById('userPricesList');
                tbody.innerHTML = '';
                snapshot.forEach(child => {
                    const part = child.val();
                    const row = tbody.insertRow();
                    const orig = part.priceOriginal ? part.priceOriginal.toFixed(2) + ' ‚Ç∫' : '-';
                    const equiv = part.priceEquivalent ? part.priceEquivalent.toFixed(2) + ' ‚Ç∫' : '-';
                    row.innerHTML = `<td>${part.brand}</td><td>${part.model}</td><td>${part.name}</td><td>${orig}</td><td>${equiv}</td>`;
                });
            });
        }

        // Edit/Delete Part Logic
        function editPart(key) {
            database.ref('parts/' + key).once('value', snapshot => {
                const part = snapshot.val();
                if (part) {
                    document.getElementById('editPartKey').value = key;
                    document.getElementById('editPartBrand').value = part.brand;
                    document.getElementById('editPartModel').value = part.model;
                    document.getElementById('editPartName').value = part.name;
                    document.getElementById('editPartPriceOriginal').value = part.priceOriginal;
                    document.getElementById('editPartPriceEquivalent').value = part.priceEquivalent || '';
                    document.getElementById('editPartModal').style.display = 'flex';
                }
            });
        }
        function closeEditModal() {
            document.getElementById('editPartModal').style.display = 'none';
        }
        document.getElementById('editPartForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const key = document.getElementById('editPartKey').value;
            const updateData = {
                brand: document.getElementById('editPartBrand').value,
                model: document.getElementById('editPartModel').value,
                name: document.getElementById('editPartName').value,
                priceOriginal: parseFloat(document.getElementById('editPartPriceOriginal').value),
                priceEquivalent: parseFloat(document.getElementById('editPartPriceEquivalent').value) || null,
                updatedAt: Date.now()
            };
            await database.ref('parts/' + key).update(updateData);
            closeEditModal();
            loadAdminPrices();
        });
        async function deletePart(key) {
            if (confirm('Silmek istiyor musunuz?')) {
                await database.ref('parts/' + key).remove();
            }
        }

        // Load Brands (User)
        function loadBrands() {
            database.ref('parts').on('value', snapshot => {
                const brands = new Set();
                snapshot.forEach(child => brands.add(child.val().brand));
                const select = document.getElementById('selectBrand');
                select.innerHTML = '<option value="">-- Marka Se√ßin --</option>';
                brands.forEach(b => {
                    const opt = document.createElement('option');
                    opt.value = b; opt.textContent = b;
                    select.appendChild(opt);
                });
            });
        }

        document.getElementById('selectBrand').addEventListener('change', function () {
            const brand = this.value;
            const modelGroup = document.getElementById('modelGroup');
            const modelSelect = document.getElementById('selectModel');

            if (!brand) {
                modelGroup.style.display = 'none';
                return;
            }

            database.ref('parts').once('value', snapshot => {
                const models = new Set();
                snapshot.forEach(child => {
                    if (child.val().brand === brand) models.add(child.val().model);
                });
                modelSelect.innerHTML = '<option value="">-- Model Se√ßin --</option>';
                models.forEach(m => {
                    const opt = document.createElement('option');
                    opt.value = m; opt.textContent = m;
                    modelSelect.appendChild(opt);
                });
                modelGroup.style.display = 'block';
                document.getElementById('partsGroup').style.display = 'none';
                document.getElementById('calculateBtn').style.display = 'none';
                document.getElementById('priceResult').style.display = 'none';
            });
        });

        document.getElementById('selectModel').addEventListener('change', function () {
            const brand = document.getElementById('selectBrand').value;
            const model = this.value;
            const partsGroup = document.getElementById('partsGroup');
            const partsList = document.getElementById('partsList');

            if (!model) {
                partsGroup.style.display = 'none';
                return;
            }

            database.ref('parts').once('value', snapshot => {
                partsList.innerHTML = '';
                snapshot.forEach(child => {
                    const p = child.val();
                    if (p.brand === brand && p.model === model) {
                        // Original
                        const divO = document.createElement('div');
                        divO.className = 'checkbox-item';
                        divO.style.cssText = "display: flex; align-items: center; padding: 0.8rem; background: #0f0f0f; border: 1px solid #333; border-radius: 0.5rem;";
                        divO.innerHTML = `
                            <input type="checkbox" id="p_${child.key}_orig" value="${child.key}_orig" data-price="${p.priceOriginal}" data-type="original" onchange="validatePartSelection()" style="margin-right: 1rem; width: 20px; height: 20px;">
                            <label for="p_${child.key}_orig" style="flex:1; cursor:pointer;">${p.name} - <strong style="color:#16a34a">Orijinal:</strong> ${p.priceOriginal} ‚Ç∫</label>
                        `;
                        partsList.appendChild(divO);

                        // Equivalent
                        if (p.priceEquivalent) {
                            const divE = document.createElement('div');
                            divE.className = 'checkbox-item';
                            divE.style.cssText = "display: flex; align-items: center; padding: 0.8rem; background: #0f0f0f; border: 1px solid #333; border-radius: 0.5rem;";
                            divE.innerHTML = `
                                <input type="checkbox" id="p_${child.key}_eq" value="${child.key}_eq" data-price="${p.priceEquivalent}" data-type="equivalent" onchange="validatePartSelection()" style="margin-right: 1rem; width: 20px; height: 20px;">
                                <label for="p_${child.key}_eq" style="flex:1; cursor:pointer;">${p.name} - <strong style="color:#f59e0b">Muadil:</strong> ${p.priceEquivalent} ‚Ç∫</label>
                            `;
                            partsList.appendChild(divE);
                        }
                    }
                });
                partsGroup.style.display = 'block';
                document.getElementById('calculateBtn').style.display = 'block';
                document.getElementById('priceResult').style.display = 'none';
            });
        });

        function validatePartSelection() {
            const checkboxes = document.querySelectorAll('#partsList input[type="checkbox"]');
            const checked = Array.from(checkboxes).filter(c => c.checked);

            // Aynƒ± par√ßanƒ±n hem orijinal hem muadil se√ßimini engelle
            const usedKeys = new Set();
            checked.forEach(c => {
                // value format: key_type (√∂rn: abc123_orig)
                const key = c.value.split('_')[0];
                usedKeys.add(key);
            });

            checkboxes.forEach(c => {
                const key = c.value.split('_')[0];
                const type = c.getAttribute('data-type');

                // Eƒüer bu par√ßanƒ±n diƒüer tipi se√ßiliyse ve kendisi se√ßili deƒüilse disable et
                const isOtherTypeSelected = Array.from(checkboxes).some(oc =>
                    oc.checked && oc.value.split('_')[0] === key && oc !== c
                );

                if (isOtherTypeSelected && !c.checked) {
                    c.disabled = true;
                } else if (checked.length >= 3 && !c.checked) {
                    c.disabled = true;
                } else {
                    c.disabled = false;
                }
            });
        }

        // Calculate Price
        document.getElementById('calculateBtn').addEventListener('click', async function () {
            const checked = document.querySelectorAll('#partsList input[type="checkbox"]:checked');
            if (checked.length === 0) {
                showAlert('userAlert', 'En az 1 par√ßa se√ßiniz.', 'error');
                return;
            }

            let total = 0;
            const breakdown = [];

            checked.forEach(c => {
                const price = parseFloat(c.getAttribute('data-price'));
                const label = c.nextElementSibling.textContent;
                total += price;
                breakdown.push({ name: label, price: price });
            });

            document.getElementById('totalPrice').textContent = total.toFixed(2) + ' ‚Ç∫';
            document.getElementById('priceBreakdown').innerHTML = breakdown.map(b => `
                <div style="display:flex; justify-content:space-between; margin-top:0.5rem;">
                    <span>${b.name}</span><span>${b.price.toFixed(2)} ‚Ç∫</span>
                </div>
            `).join('');

            // Hesaplama logunu kaydet
            const brand = document.getElementById('selectBrand').value;
            const model = document.getElementById('selectModel').value;

            // Par√ßa isimlerini temizle (sadece par√ßa adƒ±nƒ± al, fiyat bilgisini √ßƒ±kar)
            const partsInfo = breakdown.map(b => {
                const partName = b.name.split(' - ')[0].trim();
                const partType = b.name.includes('Orijinal') ? 'Orijinal' : 'Muadil';
                return `${partName} (${partType})`;
            });

            const calcLogData = {
                category: 'CALCULATION',
                action: 'Fiyat Hesaplandƒ±',
                userEmail: currentUser.email,
                userId: currentUser.uid,
                details: {
                    brand: brand,
                    model: model,
                    parts: partsInfo.join(', '),
                    partCount: breakdown.length,
                    totalPrice: parseFloat(total.toFixed(2))
                },
                timestamp: firebase.database.ServerValue.TIMESTAMP
            };

            try {
                const result = await database.ref('system_logs').push(calcLogData);
                console.log('‚úÖ Fiyat hesaplama logu kaydedildi:', {
                    user: currentUser.email,
                    brand: brand,
                    model: model,
                    parts: partsInfo.join(', '),
                    total: total.toFixed(2) + ' ‚Ç∫'
                });
            } catch (error) {
                console.error('‚ùå Fiyat hesaplama logu hatasƒ±:', error);
            }

            document.getElementById('priceResult').style.display = 'block';
        });
        // Contact Form
        document.getElementById('contactForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const data = {
                name: document.getElementById('contactName').value,
                email: document.getElementById('contactEmail').value,
                phone: document.getElementById('contactPhone').value,
                subject: document.getElementById('contactSubject').value,
                message: document.getElementById('contactMessage').value,
                userId: currentUser.uid,
                userEmail: currentUser.email,
                timestamp: Date.now()
            };
            await database.ref('contacts').push(data);
            showAlert('contactAlert', 'Mesaj g√∂nderildi.', 'success');
            this.reset();
        });
    </script>
</body>

</html>
